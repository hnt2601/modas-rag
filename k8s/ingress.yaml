---
# Ingress for HTTP/HTTPS routing
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: rag-ingress
  namespace: rag-system
  labels:
    app: rag-system
    component: ingress
  annotations:
    # NGINX Ingress Controller annotations
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
    
    # CORS settings
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/cors-allow-methods: "GET, POST, PUT, DELETE, OPTIONS"
    nginx.ingress.kubernetes.io/cors-allow-origin: "*"
    
    # SSL/TLS (uncomment when you have cert-manager)
    # cert-manager.io/cluster-issuer: letsencrypt-prod
    
    # Rate limiting (optional)
    # nginx.ingress.kubernetes.io/limit-rps: "100"
spec:
  # TLS Configuration (uncomment when you have certificates)
  # tls:
  # - hosts:
  #   - rag.yourdomain.com
  #   secretName: rag-tls-secret
  
  rules:
  - host: rag.yourdomain.com  # Change to your domain
    http:
      paths:
      # Backend API routes
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: rag-backend-service
            port:
              number: 8000
      
      # Health check endpoint
      - path: /health
        pathType: Exact
        backend:
          service:
            name: rag-backend-service
            port:
              number: 8000
      
      # Docs endpoint
      - path: /docs
        pathType: Prefix
        backend:
          service:
            name: rag-backend-service
            port:
              number: 8000
      
      # Frontend routes (when deployed)
      # - path: /
      #   pathType: Prefix
      #   backend:
      #     service:
      #       name: rag-frontend-service
      #       port:
      #         number: 80

